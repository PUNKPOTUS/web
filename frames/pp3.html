<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Video Frame Renderer</title>
  <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
</head>
<body>
  <div id="videoFrameContainer"></div>
  <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
  <script>
    // Helper function to fetch and parse HTML
    function fetchHTML(url) {
      return fetch(url)
        .then(response => response.text())
        .then(html => new DOMParser().parseFromString(html, "text/html"));
    }

    // Extract metadata from your frame
    function extractMetadata(dom) {
      return {
        videoUrl: dom.querySelector('meta[property="fc:frame:video"]').getAttribute('content'),
        videoType: dom.querySelector('meta[property="fc:frame:video:type"]').getAttribute('content'),
        imageUrl: dom.querySelector('meta[property="fc:frame:image"]').getAttribute('content'),
      };
    }

    // Create the video player
    function createMediaElement(metadata) {
      const container = document.getElementById('videoFrameContainer');
      container.innerHTML = ''; // Clear existing content

      // Use the same dimensions as your index.html
      const width = 500;
      const height = 500;

      if (metadata.videoUrl && metadata.videoType) {
        const videoElement = document.createElement('video');
        videoElement.classList.add('video-js');
        videoElement.controls = true;
        videoElement.preload = 'auto';
        videoElement.style.width = `${width}px`;
        videoElement.style.height = `${height}px`;
        videoElement.poster = metadata.imageUrl;
        videoElement.setAttribute('data-setup', '{}');

        const sourceElement = document.createElement('source');
        sourceElement.src = metadata.videoUrl;
        sourceElement.type = metadata.videoType;
        
        videoElement.appendChild(sourceElement);
        container.appendChild(videoElement);
        
        // Initialize video.js player
        videojs(videoElement);
      } else if (metadata.imageUrl) {
        // Fallback to image if video isn't available
        const imageElement = document.createElement('img');
        imageElement.src = metadata.imageUrl;
        imageElement.style.width = `${width}px`;
        imageElement.style.height = `${height}px`;
        imageElement.alt = 'Fallback Image';
        container.appendChild(imageElement);
      } else {
        container.innerText = 'Media content is not available.';
      }
    }

    // Main execution
    const frameUrl = 'https://punkpotus.one/frames'; // Replace with your index.html URL
    fetchHTML(frameUrl)
      .then(dom => extractMetadata(dom))
      .then(metadata => createMediaElement(metadata))
      .catch(error => console.error('Failed to fetch or parse HTML:', error));
  </script>
</body>
</html>
